import{b as v,r as u,u as w,j as e,H as D,L as k}from"./app-CK5W6Rwp.js";import{A as S}from"./AuthenticatedLayout-fwSN-iAm.js";function j(i){try{return new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(Number(i||0))}catch{return i}}function R({open:i,title:m,message:o,type:l="info",onClose:r}){if(!i)return null;const d=l==="success"?"text-green-700":l==="error"?"text-red-700":"text-gray-800",n=l==="success"?"border-green-200":l==="error"?"border-red-200":"border-gray-200",a=l==="success"?"bg-green-50":l==="error"?"bg-red-50":"bg-white";return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:e.jsxs("div",{className:`w-full max-w-md rounded-xl border ${n} ${a} shadow-xl`,children:[e.jsx("div",{className:"px-5 pt-5",children:e.jsx("h3",{className:`text-lg font-semibold ${d}`,children:m})}),e.jsx("div",{className:"px-5 py-4 text-sm text-gray-700 whitespace-pre-line",children:Array.isArray(o)?o.map((c,x)=>e.jsx("div",{children:c},x)):o}),e.jsx("div",{className:"px-5 pb-5 flex justify-end",children:e.jsx("button",{onClick:r,className:"inline-flex items-center rounded-lg bg-gray-900 px-4 py-2 text-sm font-semibold text-white hover:bg-gray-800",children:"OK"})})]})})}function A({balance:i,deposits:m,methods:o}){const r=v().props?.flash||{},[d,n]=u.useState({open:!1,title:"",message:"",type:"info"}),{data:a,setData:c,post:x,processing:p,reset:g,errors:t,clearErrors:f}=w({amount:"",method:o?.[0]||"UPI",reference:"",note:"",receipt:null});u.useEffect(()=>{r.success?n({open:!0,title:"Success",message:r.success,type:"success"}):r.error&&n({open:!0,title:"Error",message:r.error,type:"error"})},[r.success,r.error]);const b=u.useMemo(()=>{const s=Number(a.amount);return p||!s||s<=0},[p,a.amount]),N=s=>{s.preventDefault(),f(),x(route("wallet.deposit"),{forceFormData:!0,onSuccess:()=>{g(),n({open:!0,title:"Deposit submitted",message:"Your deposit request has been submitted successfully. It will be reviewed shortly.",type:"success"})},onError:y=>{const h=Object.values(y||{}).slice(0,5);n({open:!0,title:"Please fix the errors",message:h.length?h:"Validation failed.",type:"error"})},onFinish:()=>{}})};return e.jsxs(S,{children:[e.jsx(D,{title:"Deposit"}),e.jsx(R,{open:d.open,title:d.title,message:d.message,type:d.type,onClose:()=>n(s=>({...s,open:!1}))}),e.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow p-5 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Wallet Balance"}),e.jsxs("p",{className:"text-3xl font-bold mt-1",children:["₹ ",j(i)]})]}),e.jsx(k,{href:"/dashboard",className:"text-indigo-600 hover:underline text-sm",children:"← Back to Dashboard"})]}),e.jsxs("form",{onSubmit:N,className:"bg-white rounded-xl shadow p-6 space-y-4",encType:"multipart/form-data",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"New Deposit Request"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Amount (INR)"}),e.jsx("input",{type:"number",min:"1",step:"0.01",className:"mt-1 w-full rounded-lg border-gray-300",value:a.amount,onChange:s=>c("amount",s.target.value),required:!0}),t.amount&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Method"}),e.jsx("select",{className:"mt-1 w-full rounded-lg border-gray-300",value:a.method,onChange:s=>c("method",s.target.value),children:(o||["UPI","Bank","Cash"]).map(s=>e.jsx("option",{value:s,children:s},s))}),t.method&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.method})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Reference / Txn ID (optional)"}),e.jsx("input",{type:"text",className:"mt-1 w-full rounded-lg border-gray-300",value:a.reference,onChange:s=>c("reference",s.target.value)}),t.reference&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.reference})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Receipt (image, optional)"}),e.jsx("input",{type:"file",accept:"image/*",className:"mt-1 w-full",onChange:s=>c("receipt",s.target.files?.[0]||null)}),t.receipt&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.receipt})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Note (optional)"}),e.jsx("textarea",{rows:"2",className:"mt-1 w-full rounded-lg border-gray-300",value:a.note,onChange:s=>c("note",s.target.value)}),t.note&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.note})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:b,className:"px-4 py-2 rounded-lg bg-indigo-600 text-white font-semibold disabled:opacity-50",children:p?"Submitting...":"Submit Deposit"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Recent Deposits"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left bg-gray-50",children:[e.jsx("th",{className:"px-3 py-2",children:"#"}),e.jsx("th",{className:"px-3 py-2",children:"Date"}),e.jsx("th",{className:"px-3 py-2",children:"Amount"}),e.jsx("th",{className:"px-3 py-2",children:"Method"}),e.jsx("th",{className:"px-3 py-2",children:"Reference"}),e.jsx("th",{className:"px-3 py-2",children:"Status"}),e.jsx("th",{className:"px-3 py-2",children:"Receipt"})]})}),e.jsx("tbody",{children:m?.length?m.map(s=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-3 py-2",children:s.id}),e.jsx("td",{className:"px-3 py-2",children:new Date(s.created_at).toLocaleString()}),e.jsxs("td",{className:"px-3 py-2 font-semibold",children:["₹ ",j(s.amount)]}),e.jsx("td",{className:"px-3 py-2",children:s.method}),e.jsx("td",{className:"px-3 py-2",children:s.reference||"-"}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:s.status==="approved"?"text-green-600":s.status==="rejected"?"text-red-600":"text-yellow-700",children:s.status})}),e.jsx("td",{className:"px-3 py-2",children:s.receipt_path?e.jsx("a",{href:`/storage/${s.receipt_path}`,className:"text-indigo-600 hover:underline",target:"_blank",rel:"noreferrer",children:"View"}):"—"})]},s.id)):e.jsx("tr",{children:e.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:"7",children:"No deposits yet."})})})]})})]})]})]})}export{A as default};
