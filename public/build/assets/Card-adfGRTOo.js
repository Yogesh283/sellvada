import{b as M,r as i,j as e,H as _,a as B}from"./app-2CtFMqzh.js";import{A as E}from"./AuthenticatedLayout-CGZ4WINH.js";const d=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Number(s||0)),P="cart",L=()=>{try{const s=localStorage.getItem(P);return s?JSON.parse(s):[]}catch{return[]}},f=s=>{try{localStorage.setItem(P,JSON.stringify(s))}catch{}};function A({onClick:s,children:c,disabled:a,"aria-label":l}){return e.jsx("button",{onClick:s,"aria-label":l,disabled:a,className:"h-10 w-10 sm:h-9 sm:w-9 rounded-lg border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 active:scale-[0.98] disabled:opacity-40",type:"button",children:c})}function O({item:s,onInc:c,onDec:a,onRemove:l}){const o=Number(s.price)*Number(s.qty);return e.jsxs("div",{className:"grid grid-cols-[64px_1fr_auto] sm:grid-cols-[90px_1fr_auto_auto] gap-3 sm:gap-4 items-center border-b border-slate-100 py-3 sm:py-4",children:[e.jsx("div",{className:"h-16 w-16 sm:h-20 sm:w-20 overflow-hidden rounded-md bg-slate-100",children:e.jsx("img",{src:s.img,alt:s.name,className:"h-full w-full object-cover object-center",loading:"lazy",decoding:"async"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-[13px] sm:text-base font-semibold text-slate-900 line-clamp-2",children:s.name}),s.variant?e.jsx("div",{className:"text-[11px] sm:text-xs text-slate-500 line-clamp-1",children:s.variant}):null,e.jsx("div",{className:"mt-1 text-[13px] text-slate-700 sm:hidden",children:d(s.price)})]}),e.jsx("div",{className:"hidden sm:block text-sm font-medium text-slate-700",children:d(s.price)}),e.jsxs("div",{className:"col-span-3 sm:col-span-1 flex items-center justify-between sm:justify-end gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx(A,{onClick:a,"aria-label":"Decrease quantity",disabled:s.qty<=1,children:"−"}),e.jsx("input",{readOnly:!0,value:s.qty,className:"h-9 w-12 sm:w-14 rounded-lg border border-slate-200 bg-white text-center text-sm"}),e.jsx(A,{onClick:c,"aria-label":"Increase quantity",children:"＋"})]}),e.jsx("div",{className:"min-w-[80px] sm:min-w-[96px] text-right font-semibold text-slate-900",children:d(o)}),e.jsx("button",{onClick:l,className:"text-[12px] sm:text-xs text-rose-600 hover:text-rose-700",type:"button",children:"Remove"})]})]})}function F({items:s=null}){const{walletBalance:c=0,defaultAddress:a=null}=M().props,[l,o]=i.useState(s||[]),[j,h]=i.useState(null),[y,N]=i.useState("success"),T=t=>{N("success"),h(t),setTimeout(()=>h(null),2500)},p=t=>{N("error"),h(t||"Something went wrong."),setTimeout(()=>h(null),2500)};i.useEffect(()=>{if(s)f(s);else{const t=L();t.length&&o(t)}},[]),i.useEffect(()=>{f(l)},[l]);const[v,w]=i.useState(""),[m,k]=i.useState(null),[u,C]=i.useState(!1),b=i.useMemo(()=>l.reduce((t,r)=>t+Number(r.price)*Number(r.qty),0),[l]),g=i.useMemo(()=>m&&m==="FLAT10"?Math.round(b*.1):0,[m,b]),x=Math.max(0,b-g),q=t=>{t.preventDefault(),k(v.trim().toUpperCase()||null)},I=()=>{o([]),f([]),k(null),w("")},S=t=>{if(t.preventDefault(),!(!l.length||u)){if(!a){p("Please add a shipping address before checkout.");return}if(c<Number(x)){p(`Insufficient wallet balance to pay ${d(x)}.`);return}B.post("/checkout",{items:l,coupon:m,shipping:0},{onStart:()=>C(!0),onFinish:()=>C(!1),onSuccess:()=>{T("Order placed successfully!"),I()},onError:r=>{if(r?.wallet)p(r.wallet);else if(typeof r=="object"&&Object.keys(r).length){const n=Object.values(r)[0];p(n)}else p("Checkout failed. Please try again.")}})}};return e.jsxs(E,{children:[e.jsx(_,{title:"Your Cart"}),e.jsxs("div",{className:"bg-slate-50 overflow-x-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-cyan-600 via-sky-600 to-blue-600",children:e.jsxs("div",{className:"mx-auto max-w-6xl px-3 sm:px-6 py-3 sm:py-6 flex items-center gap-3",children:[e.jsx("img",{src:"/image/11111.png",alt:"Brand",className:"h-7 w-auto sm:h-10 shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-3xl font-bold text-white",children:"Your Shopping Cart"}),e.jsx("p",{className:"text-white/90 text-[12px] sm:text-sm truncate",children:"Review your items and proceed to checkout."})]})]})}),e.jsxs("div",{className:"mx-auto max-w-6xl px-3 sm:px-6 py-4 sm:py-8 grid gap-4 sm:gap-6 lg:grid-cols-[1.2fr_.8fr]",children:[e.jsxs("section",{className:"rounded-2xl bg-white p-4 sm:p-6 shadow ring-1 ring-slate-100",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-semibold",children:"Shipping Address"}),e.jsx("a",{href:"/address",className:"text-indigo-600 text-sm hover:underline",children:"Manage Addresses"})]}),a?e.jsxs("div",{className:"mt-2 rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm",children:[e.jsxs("div",{className:"font-semibold",children:[a.name," (",a.phone,")"]}),e.jsxs("div",{children:[a.line1,a.line2?`, ${a.line2}`:"",","," ",a.city,", ",a.state," - ",a.pincode]}),e.jsx("div",{children:a.country})]}):e.jsxs("div",{className:"mt-2 rounded-md border border-amber-300 bg-amber-50 px-3 py-2 text-sm text-amber-800",children:["No address found. Please add an address before checkout."," ",e.jsx("a",{href:"/address",className:"underline",children:"Add Address"})]})]}),l.length===0?e.jsxs("div",{className:"py-10 sm:py-16 text-center",children:[e.jsx("div",{className:"text-lg sm:text-xl font-semibold text-slate-900",children:"Your cart is empty"}),e.jsx("p",{className:"mt-1 text-slate-600",children:"Add products to continue shopping."}),e.jsx("a",{href:"/",className:"mt-4 inline-flex w-full sm:w-auto justify-center rounded-lg bg-sky-600 px-4 py-2.5 text-white font-semibold hover:bg-sky-700",children:"Browse Products"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden sm:grid grid-cols-[90px_1fr_auto_auto] gap-4 border-b border-slate-200 pb-3 text-xs font-semibold text-slate-500 uppercase tracking-wide",children:[e.jsx("div",{children:"Item"}),e.jsx("div",{children:"Product"}),e.jsx("div",{children:"Price"}),e.jsx("div",{className:"text-right",children:"Total"})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:l.map(t=>e.jsx(O,{item:t,onInc:()=>o(r=>r.map(n=>n.id===t.id?{...n,qty:n.qty+1}:n)),onDec:()=>o(r=>r.map(n=>n.id===t.id&&n.qty>1?{...n,qty:n.qty-1}:n)),onRemove:()=>o(r=>r.filter(n=>n.id!==t.id))},t.id))}),e.jsxs("form",{onSubmit:q,className:"mt-4 flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[e.jsx("input",{value:v,onChange:t=>w(t.target.value),placeholder:"Have a coupon? e.g., FLAT10",className:"w-full sm:max-w-xs rounded-lg border border-slate-200 px-3 py-2.5 text-sm",inputMode:"text",autoComplete:"off"}),e.jsx("button",{type:"submit",className:"w-full sm:w-auto rounded-lg bg-sky-600 px-4 py-2.5 text-white text-sm font-semibold hover:bg-sky-700",children:"Apply"}),m&&e.jsxs("span",{className:"text-xs font-medium text-emerald-700",children:["Applied: ",m]})]})]})]}),e.jsxs("aside",{className:"h-max rounded-2xl bg-white p-4 sm:p-6 shadow ring-1 ring-slate-100 lg:sticky lg:top-6",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Order Summary"}),e.jsxs("div",{className:"mt-2 rounded-lg bg-slate-50 px-3 py-2 text-[13px] sm:text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Wallet Balance"}),e.jsx("span",{className:"font-semibold text-slate-900",children:d(c)})]}),c<Number(x)&&e.jsxs("div",{className:"mt-1 text-[12px] text-rose-600",children:["Not enough balance to pay ",d(x),"."]})]}),e.jsxs("div",{className:"mt-3 space-y-1.5 sm:space-y-2 text-[13px] sm:text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Subtotal"}),e.jsx("span",{className:"font-medium text-slate-900",children:d(b)})]}),m&&g>0&&e.jsxs("div",{className:"flex items-center justify-between text-emerald-700",children:[e.jsx("span",{children:"Coupon Discount"}),e.jsxs("span",{children:["-",d(g)]})]}),e.jsx("div",{className:"my-2 border-t border-slate-200"}),e.jsxs("div",{className:"flex items-center justify-between text-base font-bold text-slate-900",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:d(x)})]})]}),e.jsxs("div",{className:"mt-4 sm:mt-5 grid gap-2 sm:gap-3",children:[e.jsx("button",{onClick:S,disabled:u||l.length===0,className:"w-full inline-flex items-center justify-center rounded-lg bg-gradient-to-r from-cyan-600 via-sky-600 to-blue-600 px-5 py-2.5 text-white font-semibold hover:from-cyan-700 hover:to-blue-700 disabled:opacity-60",type:"button",children:u?"Processing...":"Proceed to Checkout"}),e.jsx("a",{href:"/",className:"w-full inline-flex items-center justify-center rounded-lg border border-slate-200 px-5 py-2.5 text-slate-700 font-semibold hover:bg-slate-50",children:"Continue Shopping"})]}),!a&&e.jsxs("div",{className:"mt-3 rounded-md border border-amber-300 bg-amber-50 px-3 py-2 text-[12px] text-amber-800",children:["Please select a shipping address before checkout."," ",e.jsx("a",{href:"/address",className:"underline",children:"Add Address"})]}),e.jsx("div",{className:"mt-6 text-[11px] text-slate-500",children:"Payments supported: UPI, Cards, NetBanking. Secure checkout."})]})]}),l.length>0&&e.jsx("div",{className:"lg:hidden sticky bottom-0 inset-x-0 border-t border-slate-200 bg-white/95 backdrop-blur supports-[backdrop-filter]:bg-white/60",children:e.jsxs("div",{className:"mx-auto max-w-6xl px-3 py-2 sm:px-6 sm:py-3 flex items-center justify-between gap-3",style:{paddingBottom:"calc(env(safe-area-inset-bottom, 0px) + 8px)"},children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-slate-600",children:"Total"}),e.jsx("div",{className:"font-semibold text-slate-900",children:d(x)})]}),e.jsx("button",{onClick:S,disabled:u||l.length===0,className:"inline-flex flex-1 justify-center rounded-lg bg-sky-600 px-4 py-2.5 text-white font-semibold hover:bg-sky-700 disabled:opacity-60",type:"button",children:u?"Processing...":"Checkout"})]})})]}),j&&e.jsx("div",{className:"fixed left-1/2 z-[9999] -translate-x-1/2",style:{bottom:"calc(env(safe-area-inset-bottom, 0px) + 16px)"},children:e.jsx("div",{className:`rounded-lg px-3 sm:px-4 py-2.5 sm:py-3 text-white shadow-lg ring-1 ${y==="error"?"bg-rose-600 ring-rose-500/40":"bg-emerald-600 ring-emerald-500/40"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:y==="error"?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v4m0 4h.01M4.93 4.93l14.14 14.14M12 2a10 10 0 100 20 10 10 0 000-20z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m5 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-[13px] sm:text-sm font-medium",children:j})]})})})]})}export{F as default};
